<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
        <meta charset="utf-8"/>
	    <title>filewriter.cpp</title>
	    <link href="../../third-party/google-code-prettify/prettify-CppCoverage.css" type="text/css" rel="stylesheet" />
	    <script type="text/javascript" src="../../third-party/google-code-prettify/prettify.js"></script>
	</head>
    <body onload="prettyPrint()">
        <h4></h4>
        <pre class="prettyprint lang-cpp linenums">
#include &lt;iostream&gt;
#include &lt;Shlwapi.h&gt;
#include &lt;direct.h&gt;
#include &lt;fstream&gt;
#include &lt;vector&gt;
#include &lt;string&gt;
#include &lt;opencv2/opencv.hpp&gt;
#include "common.h"
#include "dataloader.h"
#include "filewriter.h"

<span style = "background-color:#dfd">std::ofstream writing_file;</span>

// RXgN^
FileWriter::FileWriter()
{
	//std::cout &lt;&lt; "FileWriterIuWFNg¶¬" &lt;&lt; std::endl;
	this-&gt;output_dirpath = "";
	this-&gt;file_open_flag = false;
	//throw std::exception();
}

// fXgN^
FileWriter::~FileWriter()
<span style = "background-color:#fdd">{</span>
	//std::cout &lt;&lt; "FileWriterIuWFNgjü" &lt;&lt; std::endl;
<span style = "background-color:#fdd">	writing_file.close();</span>
	//throw std::exception();
<span style = "background-color:#fdd">}</span>

// ú»Ö
int FileWriter::initialize(const Params &amp;params)
{
	if (!PathFileExists(params.output_dirpath.c_str())) // pXÌêÉoÍfBNgª¶Ý·é©Ç¤©
	{
		if (_mkdir(params.output_dirpath.c_str()) != 0) // fBNgÌì¬Å«½©Ç¤©
		{
			//std::cout &lt;&lt; "oÍfBNgðì¬Å«Ü¹ñÅµ½" &lt;&lt; std::endl;
			return -1;
		}
	}
	this-&gt;output_dirpath = params.output_dirpath;

	return 0;
}

// t@CðI[v·éÖ
int FileWriter::open_file()
<span style = "background-color:#dfd">{
	if (this-&gt;file_open_flag) // ÖðññÈãÍÀs³¹È¢(falseÌÉÀs)</span>
	{
<span style = "background-color:#dfd">		return -1;</span>
	}

<span style = "background-color:#dfd">	writing_file.open(this-&gt;output_dirpath + "\\" + this-&gt;OUTPUT_FILE_NAME);</span>

<span style = "background-color:#dfd">	if (!writing_file.is_open()) // ÙíI¹</span>
	{
		//std::cout &lt;&lt; "t@CðJ¯Ü¹ñÅµ½" &lt;&lt; std::endl;
<span style = "background-color:#dfd">		return -2;</span>
	}
<span style = "background-color:#dfd">	this-&gt;file_open_flag = true;</span>

	// oÍt@CÉtB[hðLü
<span style = "background-color:#dfd">	writing_file &lt;&lt; "frameÔ" &lt;&lt; "," &lt;&lt; "xÀW" &lt;&lt; "," &lt;&lt; "yÀW" &lt;&lt; "," &lt;&lt; "¡" &lt;&lt; "," &lt;&lt; "c" &lt;&lt; std::endl;</span>

<span style = "background-color:#dfd">	return 0;
}</span>

// t@CoÍ·éÖ
int FileWriter::output_file(DataLoader &amp;dataloader, cv::Mat &amp;img, std::vector&lt;cv::Rect&gt; &amp;faces)
<span style = "background-color:#dfd">{
	if (!this-&gt;file_open_flag) // oÍt@CªI[vµÄ¢È¢êÍÀsµÈ¢</span>
	{
<span style = "background-color:#dfd">		return -1;</span>
	}

<span style = "background-color:#dfd">	if (faces.size() == 0) // t[çoª³êÈ©Á½ê</span>
	{
		// t@C«Ý
<span style = "background-color:#dfd">		writing_file &lt;&lt; dataloader.get_frame_info() &lt;&lt; "," &lt;&lt; "-1" &lt;&lt; "," &lt;&lt; "-1" &lt;&lt; "," &lt;&lt; "-1" &lt;&lt; "," &lt;&lt; "-1" &lt;&lt; std::endl;</span>
	}
<span style = "background-color:#fdd">	else</span>
	{
		// oµ½çÌÂfaces.size()ª[vðs¤
<span style = "background-color:#dfd">		for (int i = 0; i &lt; faces.size(); i++)</span>
		{
			// oµ½çðÔFé`ÅÍÞ
<span style = "background-color:#dfd">			cv::rectangle(img, cv::Point(faces[i].x, faces[i].y), cv::Point(faces[i].x + faces[i].width, faces[i].y + faces[i].height), cv::Scalar(0, 0, 255), 2);</span>

			// t@C«Ý
<span style = "background-color:#dfd">			writing_file &lt;&lt; dataloader.get_frame_info() &lt;&lt; "," &lt;&lt; faces[i].x &lt;&lt; "," &lt;&lt; faces[i].y &lt;&lt; "," &lt;&lt; faces[i].width &lt;&lt; "," &lt;&lt; faces[i].height &lt;&lt; std::endl;</span>
		}
	}
<span style = "background-color:#dfd">	return 0;
}</span></pre>
        <hr />
        <table width="100%">
            <thead>
                <tr>
                    <th align="center">
                        <small>Generated by</small>
                        <a href="https://github.com/OpenCppCoverage/OpenCppCoverage/releases">
                            <strong>OpenCppCoverage (Version: 0.9.9.0)</strong>
                        </a>
                    </th>
                </tr>
            </thead>
        </table>
    </body>
</html>